<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Learn Programming with Kuai - Tutorials and Exercises."><meta name=author content="Kuai Yu"><link rel=canonical href=https://yukuairoy.github.io/codespree/Miscellaneous/ciphers/ciphers.html><link rel=prev href=../../Exercises/mini_projects.html><link rel=next href=../trees/trees_and_forests.html><link rel=icon href=../../images/favicon.jpeg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.50"><title>Ciphers - CodeSpree</title><link rel=stylesheet href=../../assets/stylesheets/main.a40c8224.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><script src=https://unpkg.com/iframe-worker/shim></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property=og:type content=website><meta property=og:title content="Ciphers - CodeSpree"><meta property=og:description content="Learn Programming with Kuai - Tutorials and Exercises."><meta property=og:image content=https://yukuairoy.github.io/codespree/assets/images/social/Miscellaneous/ciphers/ciphers.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta property=og:url content=https://yukuairoy.github.io/codespree/Miscellaneous/ciphers/ciphers.html><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="Ciphers - CodeSpree"><meta name=twitter:description content="Learn Programming with Kuai - Tutorials and Exercises."><meta name=twitter:image content=https://yukuairoy.github.io/codespree/assets/images/social/Miscellaneous/ciphers/ciphers.png></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=red data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#classical-ciphers class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../index.html title=CodeSpree class="md-header__button md-logo" aria-label=CodeSpree data-md-component=logo> <img src=../../images/favicon.jpeg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> CodeSpree </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Ciphers </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../index.html title=CodeSpree class="md-nav__button md-logo" aria-label=CodeSpree data-md-component=logo> <img src=../../images/favicon.jpeg alt=logo> </a> CodeSpree </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../index.html class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Python 101 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Python 101 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Python101/Python_Basics.html class=md-nav__link> <span class=md-ellipsis> Python Basics </span> </a> </li> <li class=md-nav__item> <a href=../../Python101/Control_Flow.html class=md-nav__link> <span class=md-ellipsis> Control Flow </span> </a> </li> <li class=md-nav__item> <a href=../../Python101/Object_Oriented_Programming.html class=md-nav__link> <span class=md-ellipsis> OOP </span> </a> </li> <li class=md-nav__item> <a href=../../Python101/Managing_Imports.html class=md-nav__link> <span class=md-ellipsis> Managing Imports </span> </a> </li> <li class=md-nav__item> <a href=../../Python101/pip.html class=md-nav__link> <span class=md-ellipsis> Dependency Management </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Exercises </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Exercises </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Exercises/programming_exercises.html class=md-nav__link> <span class=md-ellipsis> Programming Exercises </span> </a> </li> <li class=md-nav__item> <a href=../../Exercises/mini_projects.html class=md-nav__link> <span class=md-ellipsis> Mini-Projects </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Miscellaneous </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Miscellaneous </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Ciphers </span> <span class="md-nav__icon md-icon"></span> </label> <a href=ciphers.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Ciphers </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#substitution-ciphers class=md-nav__link> <span class=md-ellipsis> Substitution Ciphers </span> </a> <nav class=md-nav aria-label="Substitution Ciphers"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#atbash class=md-nav__link> <span class=md-ellipsis> Atbash </span> </a> <nav class=md-nav aria-label=Atbash> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#caesar class=md-nav__link> <span class=md-ellipsis> Caesar </span> </a> <nav class=md-nav aria-label=Caesar> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_1 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_1 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> <li class=md-nav__item> <a href=#cryptanalysis class=md-nav__link> <span class=md-ellipsis> Cryptanalysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#affine class=md-nav__link> <span class=md-ellipsis> Affine </span> </a> <nav class=md-nav aria-label=Affine> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_2 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_2 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> <li class=md-nav__item> <a href=#cryptanalysis_1 class=md-nav__link> <span class=md-ellipsis> Cryptanalysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vigenere class=md-nav__link> <span class=md-ellipsis> Vigenère </span> </a> <nav class=md-nav aria-label=Vigenère> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_3 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_3 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> <li class=md-nav__item> <a href=#cryptanalysis_2 class=md-nav__link> <span class=md-ellipsis> Cryptanalysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#one-time-pad class=md-nav__link> <span class=md-ellipsis> One-time Pad </span> </a> <nav class=md-nav aria-label="One-time Pad"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_4 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_4 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> <li class=md-nav__item> <a href=#cryptanalysis_3 class=md-nav__link> <span class=md-ellipsis> Cryptanalysis </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transposition-ciphers class=md-nav__link> <span class=md-ellipsis> Transposition Ciphers </span> </a> <nav class=md-nav aria-label="Transposition Ciphers"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#columnar-transposition class=md-nav__link> <span class=md-ellipsis> Columnar transposition </span> </a> <nav class=md-nav aria-label="Columnar transposition"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_5 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_5 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> <li class=md-nav__item> <a href=#cryptanalysis_4 class=md-nav__link> <span class=md-ellipsis> Cryptanalysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#rail-fence class=md-nav__link> <span class=md-ellipsis> Rail fence </span> </a> <nav class=md-nav aria-label="Rail fence"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_6 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_6 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> <li class=md-nav__item> <a href=#cryptanalysis_5 class=md-nav__link> <span class=md-ellipsis> Cryptanalysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#route class=md-nav__link> <span class=md-ellipsis> Route </span> </a> <nav class=md-nav aria-label=Route> <ul class=md-nav__list> <li class=md-nav__item> <a href=#diagonal-pattern class=md-nav__link> <span class=md-ellipsis> Diagonal pattern </span> </a> <nav class=md-nav aria-label="Diagonal pattern"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_7 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_7 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#spiral-pattern class=md-nav__link> <span class=md-ellipsis> Spiral pattern </span> </a> <nav class=md-nav aria-label="Spiral pattern"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_8 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_8 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cryptanalysis_6 class=md-nav__link> <span class=md-ellipsis> Cryptanalysis </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class=md-ellipsis> Trees </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Trees </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../trees/trees_and_forests.html class=md-nav__link> <span class=md-ellipsis> Trees and Forests </span> </a> </li> <li class=md-nav__item> <a href=../trees/rooted_tree.html class=md-nav__link> <span class=md-ellipsis> Rooted Trees </span> </a> </li> <li class=md-nav__item> <a href=../trees/k_ary_tree.html class=md-nav__link> <span class=md-ellipsis> k-ary Trees </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../birthday/birthday.html class=md-nav__link> <span class=md-ellipsis> The Birthday Problem </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#substitution-ciphers class=md-nav__link> <span class=md-ellipsis> Substitution Ciphers </span> </a> <nav class=md-nav aria-label="Substitution Ciphers"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#atbash class=md-nav__link> <span class=md-ellipsis> Atbash </span> </a> <nav class=md-nav aria-label=Atbash> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#caesar class=md-nav__link> <span class=md-ellipsis> Caesar </span> </a> <nav class=md-nav aria-label=Caesar> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_1 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_1 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> <li class=md-nav__item> <a href=#cryptanalysis class=md-nav__link> <span class=md-ellipsis> Cryptanalysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#affine class=md-nav__link> <span class=md-ellipsis> Affine </span> </a> <nav class=md-nav aria-label=Affine> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_2 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_2 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> <li class=md-nav__item> <a href=#cryptanalysis_1 class=md-nav__link> <span class=md-ellipsis> Cryptanalysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vigenere class=md-nav__link> <span class=md-ellipsis> Vigenère </span> </a> <nav class=md-nav aria-label=Vigenère> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_3 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_3 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> <li class=md-nav__item> <a href=#cryptanalysis_2 class=md-nav__link> <span class=md-ellipsis> Cryptanalysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#one-time-pad class=md-nav__link> <span class=md-ellipsis> One-time Pad </span> </a> <nav class=md-nav aria-label="One-time Pad"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_4 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_4 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> <li class=md-nav__item> <a href=#cryptanalysis_3 class=md-nav__link> <span class=md-ellipsis> Cryptanalysis </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transposition-ciphers class=md-nav__link> <span class=md-ellipsis> Transposition Ciphers </span> </a> <nav class=md-nav aria-label="Transposition Ciphers"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#columnar-transposition class=md-nav__link> <span class=md-ellipsis> Columnar transposition </span> </a> <nav class=md-nav aria-label="Columnar transposition"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_5 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_5 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> <li class=md-nav__item> <a href=#cryptanalysis_4 class=md-nav__link> <span class=md-ellipsis> Cryptanalysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#rail-fence class=md-nav__link> <span class=md-ellipsis> Rail fence </span> </a> <nav class=md-nav aria-label="Rail fence"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_6 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_6 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> <li class=md-nav__item> <a href=#cryptanalysis_5 class=md-nav__link> <span class=md-ellipsis> Cryptanalysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#route class=md-nav__link> <span class=md-ellipsis> Route </span> </a> <nav class=md-nav aria-label=Route> <ul class=md-nav__list> <li class=md-nav__item> <a href=#diagonal-pattern class=md-nav__link> <span class=md-ellipsis> Diagonal pattern </span> </a> <nav class=md-nav aria-label="Diagonal pattern"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_7 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_7 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#spiral-pattern class=md-nav__link> <span class=md-ellipsis> Spiral pattern </span> </a> <nav class=md-nav aria-label="Spiral pattern"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_8 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#implementation_8 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cryptanalysis_6 class=md-nav__link> <span class=md-ellipsis> Cryptanalysis </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=classical-ciphers>Classical Ciphers<a class=headerlink href=#classical-ciphers title="Permanent link">&para;</a></h1> <p>The main classical cipher types are <a href=https://en.wikipedia.org/wiki/Transposition_cipher>transposition ciphers</a>, which rearrange the order of letters in a message (e.g., 'hello world' becomes 'ehlol owrdl' in a trivially simple rearrangement scheme), and <a href=https://en.wikipedia.org/wiki/Substitution_cipher>substitution ciphers</a>, which systematically replace letters or groups of letters with other letters or groups of letters (e.g., 'fly at once' becomes 'gmz bu podf' by replacing each letter with the one following it in the Latin alphabet).</p> <p>Many classical ciphers are vulnerable to <a href=https://en.wikipedia.org/wiki/Frequency_analysis>frequency analysis</a>.</p> <h2 id=substitution-ciphers>Substitution Ciphers<a class=headerlink href=#substitution-ciphers title="Permanent link">&para;</a></h2> <p>A substitution cipher changes one character into another.</p> <h3 id=atbash><a href=https://en.wikipedia.org/wiki/Atbash>Atbash</a><a class=headerlink href=#atbash title="Permanent link">&para;</a></h3> <p>The alphabet is mapped to its reverse, so an "A" becomes a "Z", "B" turns into "Y", etc.</p> <h4 id=examples>Examples<a class=headerlink href=#examples title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Plaintext</th> <th>Ciphertext</th> </tr> </thead> <tbody> <tr> <td>May the Force be with you.</td> <td>Nzb gsv Ulixv yv drgs blf.</td> </tr> <tr> <td>tomorrow is another day</td> <td>glnliild rh zmlgsvi wzb</td> </tr> </tbody> </table> <h4 id=implementation>Implementation<a class=headerlink href=#implementation title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=k>def</span><span class=w> </span><span class=nf>encrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>_translate</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=k>if</span> <span class=n>is_english_letter</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=k>else</span> <span class=n>s</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>msg</span><span class=p>)</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=k>def</span><span class=w> </span><span class=nf>decrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>    <span class=k>return</span> <span class=n>encrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=k>def</span><span class=w> </span><span class=nf>_translate</span><span class=p>(</span><span class=n>s</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>    <span class=k>if</span> <span class=n>s</span><span class=o>.</span><span class=n>isupper</span><span class=p>():</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>        <span class=k>return</span> <span class=nb>chr</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=s2>&quot;A&quot;</span><span class=p>)</span> <span class=o>+</span> <span class=nb>ord</span><span class=p>(</span><span class=s2>&quot;Z&quot;</span><span class=p>)</span> <span class=o>-</span> <span class=nb>ord</span><span class=p>(</span><span class=n>s</span><span class=p>))</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>        <span class=k>return</span> <span class=nb>chr</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=s2>&quot;a&quot;</span><span class=p>)</span> <span class=o>+</span> <span class=nb>ord</span><span class=p>(</span><span class=s2>&quot;z&quot;</span><span class=p>)</span> <span class=o>-</span> <span class=nb>ord</span><span class=p>(</span><span class=n>s</span><span class=p>))</span>
</span></code></pre></div> <p>Below is a utility function that checks if a letter is an English letter.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=k>def</span><span class=w> </span><span class=nf>is_english_letter</span><span class=p>(</span><span class=n>s</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>    <span class=k>return</span> <span class=n>s</span><span class=o>.</span><span class=n>isascii</span><span class=p>()</span> <span class=ow>and</span> <span class=n>s</span><span class=o>.</span><span class=n>isalpha</span><span class=p>()</span>
</span></code></pre></div> <p>Notes:</p> <ul> <li>Non-Latin letters are kept as-is.</li> <li><code>_translate(s)</code> preserves the case of <code>s</code>.</li> </ul> <h3 id=caesar><a href=https://en.wikipedia.org/wiki/Caesar_cipher>Caesar</a><a class=headerlink href=#caesar title="Permanent link">&para;</a></h3> <p>Each letter in the plaintext is replaced by a letter some fixed number of positions down the alphabet. For example, with a right shift of 3, A would be replaced by D, B would become E, and so on.</p> <h4 id=examples_1>Examples<a class=headerlink href=#examples_1 title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Plaintext</th> <th>shift</th> <th>Ciphertext</th> </tr> </thead> <tbody> <tr> <td>May the Force be with you.</td> <td>1</td> <td>Nbz uif Gpsdf cf xjui zpv.</td> </tr> <tr> <td>tomorrow is another day</td> <td>3</td> <td>wrpruurz lv dqrwkhu gdb</td> </tr> </tbody> </table> <h4 id=implementation_1>Implementation<a class=headerlink href=#implementation_1 title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=k>def</span><span class=w> </span><span class=nf>encrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>k</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>right_shift</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>k</span><span class=p>)</span> <span class=k>if</span> <span class=n>is_english_letter</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=k>else</span> <span class=n>s</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>msg</span><span class=p>)</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=k>def</span><span class=w> </span><span class=nf>decrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>k</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>right_shift</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=o>-</span><span class=n>k</span><span class=p>)</span> <span class=k>if</span> <span class=n>is_english_letter</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=k>else</span> <span class=n>s</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>msg</span><span class=p>)</span>
</span></code></pre></div> <p>Below is a utility function that does the right shift. Supply <code>right_shift()</code> with <code>-k</code> to make <code>k</code> shifts to the left.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=k>def</span><span class=w> </span><span class=nf>right_shift</span><span class=p>(</span><span class=n>s</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>shift</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>    <span class=n>start</span> <span class=o>=</span> <span class=s2>&quot;A&quot;</span> <span class=k>if</span> <span class=n>s</span><span class=o>.</span><span class=n>isupper</span><span class=p>()</span> <span class=k>else</span> <span class=s2>&quot;a&quot;</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>    <span class=n>plain_code</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=o>-</span> <span class=nb>ord</span><span class=p>(</span><span class=n>start</span><span class=p>)</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>    <span class=n>cipher_code</span> <span class=o>=</span> <span class=p>(</span><span class=n>plain_code</span> <span class=o>+</span> <span class=n>shift</span><span class=p>)</span> <span class=o>%</span> <span class=mi>26</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>    <span class=k>return</span> <span class=nb>chr</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>start</span><span class=p>)</span> <span class=o>+</span> <span class=n>cipher_code</span><span class=p>)</span>
</span></code></pre></div> <h4 id=cryptanalysis>Cryptanalysis<a class=headerlink href=#cryptanalysis title="Permanent link">&para;</a></h4> <p>A brute force attack can easily break Caesar cipher since there are only a limited number of possible shifts.</p> <h3 id=affine><a href=https://en.wikipedia.org/wiki/Affine_cipher>Affine</a><a class=headerlink href=#affine title="Permanent link">&para;</a></h3> <p>A key consists of two numbers <span class=arithmatex>\(m\)</span> and <span class=arithmatex>\(b\)</span>, where <span class=arithmatex>\(m\)</span> is coprime to the length of the alphabet. Then to get the ciphertext for the letter with character code <span class=arithmatex>\(x\)</span>, we compute <span class=arithmatex>\(mx + b\)</span> and reduce modulo the length of the alphabet.</p> <p>To decrypt, we just reverse the process: for each character of the ciphertext, subtract <code>b</code> and then multiply by the <a href=https://en.wikipedia.org/wiki/Modular_multiplicative_inverse>modular multiplicative inverse</a> of <span class=arithmatex>\(m\)</span> modulo the length of the alphabet.</p> <p>The Caesar cipher is an Affine cipher with <span class=arithmatex>\(m = 1\)</span>. The Atbash cipher is an Affine cipher with <span class=arithmatex>\(m = b = 25\)</span>.</p> <h4 id=examples_2>Examples<a class=headerlink href=#examples_2 title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Plaintext</th> <th>m</th> <th>b</th> <th>Ciphertext</th> </tr> </thead> <tbody> <tr> <td>May the Force be with you.</td> <td>1</td> <td>1</td> <td>Nbz uif Gpsdf cf xjui zpv.</td> </tr> <tr> <td>tomorrow is another day</td> <td>25</td> <td>25</td> <td>glnliild rh zmlgsvi wzb</td> </tr> <tr> <td>May the Force be with you.</td> <td>3</td> <td>4</td> <td>Oey jzq Tudkq hq scjz yum.</td> </tr> <tr> <td>tomorrow is another day</td> <td>15</td> <td>6</td> <td>fieibbiy wq gtifhob zgc</td> </tr> </tbody> </table> <h4 id=implementation_2>Implementation<a class=headerlink href=#implementation_2 title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kn>from</span><span class=w> </span><span class=nn>math</span><span class=w> </span><span class=kn>import</span> <span class=n>gcd</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=k>def</span><span class=w> </span><span class=nf>encrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>m</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>b</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>    <span class=k>if</span> <span class=n>gcd</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=mi>26</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>m</span><span class=si>}</span><span class=s2> and 26 are not relatively prime&quot;</span><span class=p>)</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>_encrypt</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span> <span class=k>if</span> <span class=n>is_english_letter</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=k>else</span> <span class=n>s</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>msg</span><span class=p>)</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=k>def</span><span class=w> </span><span class=nf>decrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>m</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>b</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>    <span class=k>if</span> <span class=n>gcd</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=mi>26</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>m</span><span class=si>}</span><span class=s2> and 26 are not relatively prime&quot;</span><span class=p>)</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>_decrypt</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span> <span class=k>if</span> <span class=n>is_english_letter</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=k>else</span> <span class=n>s</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>msg</span><span class=p>)</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=k>def</span><span class=w> </span><span class=nf>_encrypt</span><span class=p>(</span><span class=n>s</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>m</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>b</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>    <span class=n>start</span> <span class=o>=</span> <span class=s2>&quot;A&quot;</span> <span class=k>if</span> <span class=n>s</span><span class=o>.</span><span class=n>isupper</span><span class=p>()</span> <span class=k>else</span> <span class=s2>&quot;a&quot;</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>    <span class=n>plain_code</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=o>-</span> <span class=nb>ord</span><span class=p>(</span><span class=n>start</span><span class=p>)</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>    <span class=n>cipher_code</span> <span class=o>=</span> <span class=p>(</span><span class=n>m</span> <span class=o>*</span> <span class=n>plain_code</span> <span class=o>+</span> <span class=n>b</span><span class=p>)</span> <span class=o>%</span> <span class=mi>26</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>    <span class=k>return</span> <span class=nb>chr</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>start</span><span class=p>)</span> <span class=o>+</span> <span class=n>cipher_code</span><span class=p>)</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=k>def</span><span class=w> </span><span class=nf>_decrypt</span><span class=p>(</span><span class=n>s</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>m</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>b</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a>    <span class=n>start</span> <span class=o>=</span> <span class=s2>&quot;A&quot;</span> <span class=k>if</span> <span class=n>s</span><span class=o>.</span><span class=n>isupper</span><span class=p>()</span> <span class=k>else</span> <span class=s2>&quot;a&quot;</span>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a>    <span class=n>plain_code</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=o>-</span> <span class=nb>ord</span><span class=p>(</span><span class=n>start</span><span class=p>)</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a>    <span class=n>cipher_code</span> <span class=o>=</span> <span class=p>((</span><span class=n>plain_code</span> <span class=o>-</span> <span class=n>b</span><span class=p>)</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>26</span><span class=p>))</span> <span class=o>%</span> <span class=mi>26</span>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a>    <span class=k>return</span> <span class=nb>chr</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>start</span><span class=p>)</span> <span class=o>+</span> <span class=n>cipher_code</span><span class=p>)</span>
</span></code></pre></div> <p>Note: <code>pow(m, -1, 26)</code> computes the modular multiplicative inverse of <code>m</code> modulo 26.</p> <p>The <code>gcd</code> isn't hard to implement ourselves. The function below uses <a href=https://en.wikipedia.org/wiki/Euclidean_algorithm>Euclidean algorithm</a> and has <span class=arithmatex>\(O(\log(\min(a, b)))\)</span> time complexity.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=k>def</span><span class=w> </span><span class=nf>gcd</span><span class=p>(</span><span class=n>a</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>b</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>    <span class=k>if</span> <span class=n>b</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>        <span class=k>return</span> <span class=nb>abs</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>    <span class=k>return</span> <span class=n>gcd</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>%</span> <span class=n>b</span><span class=p>)</span>
</span></code></pre></div> <h4 id=cryptanalysis_1>Cryptanalysis<a class=headerlink href=#cryptanalysis_1 title="Permanent link">&para;</a></h4> <p>If you know a message is encrypted with an affine cipher, you only need to determine what two letters are to crack the encryption by solving a simultaneous equation.</p> <h3 id=vigenere><a href=https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher>Vigenère</a><a class=headerlink href=#vigenere title="Permanent link">&para;</a></h3> <p>In the Vigenère Cipher, we choose a word or phrase as our encryption key. We then convert it to a sequence of numbers (using <code>a=0, b=1, ..., z=25</code>), and apply a different shift to the plaintext corresponding to the letters in the keyword. When we use up the shifts from the keyword, we repeat it again.</p> <h4 id=examples_3>Examples<a class=headerlink href=#examples_3 title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Plaintext</th> <th>key</th> <th>Ciphertext</th> </tr> </thead> <tbody> <tr> <td>May the Force be with you.</td> <td>world</td> <td>Iop eka Tfcfa pv hlpv pzx.</td> </tr> <tr> <td>tomorrow is another day</td> <td>cat</td> <td>vofqrkqw bu agqtagr wcy</td> </tr> </tbody> </table> <h4 id=implementation_3>Implementation<a class=headerlink href=#implementation_3 title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=k>def</span><span class=w> </span><span class=nf>encrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>    <span class=n>key_to_ints</span> <span class=o>=</span> <span class=n>str_to_ints</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>    <span class=n>encrypted</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>    <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>msg</span><span class=p>:</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>        <span class=k>if</span> <span class=n>is_english_letter</span><span class=p>(</span><span class=n>s</span><span class=p>):</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>            <span class=n>encrypted</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>right_shift</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>key_to_ints</span><span class=p>[</span><span class=n>i</span><span class=p>]))</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>            <span class=n>i</span> <span class=o>=</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>key_to_ints</span><span class=p>)</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>            <span class=n>encrypted</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>encrypted</span><span class=p>)</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=k>def</span><span class=w> </span><span class=nf>decrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a>    <span class=n>key_to_ints</span> <span class=o>=</span> <span class=n>str_to_ints</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a>    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a>    <span class=n>decrypted</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a>    <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>msg</span><span class=p>:</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a>        <span class=k>if</span> <span class=n>is_english_letter</span><span class=p>(</span><span class=n>s</span><span class=p>):</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a>            <span class=n>decrypted</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>right_shift</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=o>-</span><span class=n>key_to_ints</span><span class=p>[</span><span class=n>i</span><span class=p>]))</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a>            <span class=n>i</span> <span class=o>=</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>key_to_ints</span><span class=p>)</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a>            <span class=n>decrypted</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>decrypted</span><span class=p>)</span>
</span></code></pre></div> <p>The encryption key is converted to a list of integers by first converting it to lower case and then ignoring non-English characters.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>def</span><span class=w> </span><span class=nf>str_to_ints</span><span class=p>(</span><span class=n>s</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>int</span><span class=p>]:</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>    <span class=k>return</span> <span class=p>[</span><span class=nb>ord</span><span class=p>(</span><span class=n>char</span><span class=p>)</span> <span class=o>-</span> <span class=nb>ord</span><span class=p>(</span><span class=s2>&quot;a&quot;</span><span class=p>)</span> <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>s</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=k>if</span> <span class=n>is_english_letter</span><span class=p>(</span><span class=n>char</span><span class=p>)]</span>
</span></code></pre></div> <h4 id=cryptanalysis_2>Cryptanalysis<a class=headerlink href=#cryptanalysis_2 title="Permanent link">&para;</a></h4> <p>The primary weakness of the Vigenère cipher is the repeating nature of its key. If a cryptanalyst correctly guesses the key's length <span class=arithmatex>\(n\)</span>, the cipher text can be treated as <span class=arithmatex>\(n\)</span> interleaved Caesar ciphers, which can easily be broken individually.</p> <h3 id=one-time-pad><a href=https://en.wikipedia.org/wiki/One-time_pad>One-time Pad</a><a class=headerlink href=#one-time-pad title="Permanent link">&para;</a></h3> <p>A plaintext is paired with a random secret key (also referred to as a one-time pad). The pad must not be shorter than the plaintext. Then, each character of the plaintext is combined with the corresponding character from the pad using modular addition.</p> <h4 id=examples_4>Examples<a class=headerlink href=#examples_4 title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Plaintext</th> <th>pad</th> <th>Ciphertext</th> </tr> </thead> <tbody> <tr> <td>May the Force be with you.</td> <td>NbzuifGpsdfcfxjuizpstapq</td> <td>Zbx npj Ldjfj dj trnp xdm.</td> </tr> <tr> <td>tomorrow is another day</td> <td>upnpsspxjtbopuifsebz</td> <td>ndzdjjdt rl bbdnpjj hbx</td> </tr> <tr> <td>Why so serious</td> <td>yhphsvmvuous</td> <td>Uon zg nqmccok</td> </tr> </tbody> </table> <h4 id=implementation_4>Implementation<a class=headerlink href=#implementation_4 title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=k>def</span><span class=w> </span><span class=nf>encrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>pad</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>    <span class=n>key_to_ints</span> <span class=o>=</span> <span class=n>str_to_ints</span><span class=p>(</span><span class=n>pad</span><span class=p>)</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>    <span class=n>encrypted</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>    <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>msg</span><span class=p>:</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>        <span class=k>if</span> <span class=n>is_english_letter</span><span class=p>(</span><span class=n>s</span><span class=p>):</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>            <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>key_to_ints</span><span class=p>):</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;pad is too short&quot;</span><span class=p>)</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>            <span class=n>encrypted</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>right_shift</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>key_to_ints</span><span class=p>[</span><span class=n>i</span><span class=p>]))</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>            <span class=n>encrypted</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>encrypted</span><span class=p>)</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=k>def</span><span class=w> </span><span class=nf>decrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>pad</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a>    <span class=n>key_to_ints</span> <span class=o>=</span> <span class=n>str_to_ints</span><span class=p>(</span><span class=n>pad</span><span class=p>)</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a>    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a>    <span class=n>decrypted</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a>    <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>msg</span><span class=p>:</span>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a>        <span class=k>if</span> <span class=n>is_english_letter</span><span class=p>(</span><span class=n>s</span><span class=p>):</span>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a>            <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>key_to_ints</span><span class=p>):</span>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;pad is too short&quot;</span><span class=p>)</span>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a>            <span class=n>decrypted</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>right_shift</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=o>-</span><span class=n>key_to_ints</span><span class=p>[</span><span class=n>i</span><span class=p>]))</span>
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a>            <span class=n>decrypted</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>decrypted</span><span class=p>)</span>
</span></code></pre></div> <h4 id=cryptanalysis_3>Cryptanalysis<a class=headerlink href=#cryptanalysis_3 title="Permanent link">&para;</a></h4> <p>The security of the system stems from the fact that any plaintext can encrypt to any ciphertext of the same length. It's critical that the random numbers are truly random and cannot be <a href=https://en.wikipedia.org/wiki/Pseudorandomness>pseudorandom</a>.</p> <h2 id=transposition-ciphers>Transposition Ciphers<a class=headerlink href=#transposition-ciphers title="Permanent link">&para;</a></h2> <p>A transposition cipher reorders the plaintext. One of the key benefits of a transposition cipher over a substitution cipher such as an affine cipher is that a transposition cipher can be applied more than once.</p> <h3 id=columnar-transposition><a href=https://en.wikipedia.org/wiki/Transposition_cipher#Columnar_transposition>Columnar transposition</a><a class=headerlink href=#columnar-transposition title="Permanent link">&para;</a></h3> <p>In a columnar transposition, the message is written out in rows of a fixed length, and then read out again column by column, and the columns are rearranged. Both the width of the rows and the permutation of the columns are defined by a keyword.</p> <h4 id=examples_5>Examples<a class=headerlink href=#examples_5 title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Plaintext</th> <th>key</th> <th>Ciphertext</th> </tr> </thead> <tbody> <tr> <td>May the Force be with you.</td> <td>zephyr</td> <td>a t. oe yFbhhcwotr yMeeiu</td> </tr> <tr> <td>tomorrow is another day</td> <td>AMPLE</td> <td>trstdrio o nroo hamwaey</td> </tr> <tr> <td>What we've got here is failure to communicate.</td> <td>DIVERT</td> <td>Weoea matehsu n.h't itmt e rciwgrfeocav iloue</td> </tr> </tbody> </table> <h4 id=implementation_5>Implementation<a class=headerlink href=#implementation_5 title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=k>def</span><span class=w> </span><span class=nf>encrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>    <span class=n>key</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>k</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span> <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=n>key</span> <span class=k>if</span> <span class=n>is_english_letter</span><span class=p>(</span><span class=n>k</span><span class=p>))</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>key</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>2</span> <span class=ow>or</span> <span class=nb>len</span><span class=p>(</span><span class=n>key</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=nb>len</span><span class=p>(</span><span class=n>msg</span><span class=p>):</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;key length must be in [2, </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span><span class=si>}</span><span class=s2>]&quot;</span><span class=p>)</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>    <span class=n>rows</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>    <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>msg</span><span class=p>:</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>rows</span> <span class=ow>or</span> <span class=nb>len</span><span class=p>(</span><span class=n>rows</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>key</span><span class=p>):</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>            <span class=n>rows</span><span class=o>.</span><span class=n>append</span><span class=p>([])</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>        <span class=n>rows</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>    <span class=n>columns</span> <span class=o>=</span> <span class=p>[[]</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=n>key</span><span class=p>]</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>key</span><span class=p>)):</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>        <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>rows</span><span class=p>:</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a>            <span class=k>if</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>row</span><span class=p>):</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a>                <span class=n>columns</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>col</span><span class=p>)</span> <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>col</span> <span class=ow>in</span> <span class=nb>sorted</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>columns</span><span class=p>)))</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a><span class=k>def</span><span class=w> </span><span class=nf>decrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>key</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a>    <span class=n>key</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>k</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span> <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=n>key</span> <span class=k>if</span> <span class=n>is_english_letter</span><span class=p>(</span><span class=n>k</span><span class=p>))</span>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>key</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>2</span> <span class=ow>or</span> <span class=nb>len</span><span class=p>(</span><span class=n>key</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=nb>len</span><span class=p>(</span><span class=n>msg</span><span class=p>):</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;key length must be in [2, </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span><span class=si>}</span><span class=s2>]&quot;</span><span class=p>)</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a>    <span class=n>k</span><span class=p>,</span> <span class=n>r</span> <span class=o>=</span> <span class=nb>divmod</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>msg</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>key</span><span class=p>))</span>
</span><span id=__span-9-22><a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a>    <span class=n>columns</span> <span class=o>=</span> <span class=p>[[]</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>key</span><span class=p>))]</span>
</span><span id=__span-9-23><a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a>    <span class=n>idx</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-9-24><a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>sorted</span><span class=p>((</span><span class=n>k</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>key</span><span class=p>)):</span>
</span><span id=__span-9-25><a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a>        <span class=n>size</span> <span class=o>=</span> <span class=n>k</span> <span class=o>+</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>r</span> <span class=k>else</span> <span class=n>k</span>
</span><span id=__span-9-26><a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a>        <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>size</span><span class=p>):</span>
</span><span id=__span-9-27><a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a>            <span class=n>columns</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>msg</span><span class=p>[</span><span class=n>idx</span><span class=p>])</span>
</span><span id=__span-9-28><a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a>            <span class=n>idx</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-9-29><a id=__codelineno-9-29 name=__codelineno-9-29 href=#__codelineno-9-29></a>    <span class=n>decrypted</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-9-30><a id=__codelineno-9-30 name=__codelineno-9-30 href=#__codelineno-9-30></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>k</span> <span class=o>+</span> <span class=p>(</span><span class=n>r</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)):</span>
</span><span id=__span-9-31><a id=__codelineno-9-31 name=__codelineno-9-31 href=#__codelineno-9-31></a>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>key</span><span class=p>)):</span>
</span><span id=__span-9-32><a id=__codelineno-9-32 name=__codelineno-9-32 href=#__codelineno-9-32></a>            <span class=k>if</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>columns</span><span class=p>[</span><span class=n>j</span><span class=p>]):</span>
</span><span id=__span-9-33><a id=__codelineno-9-33 name=__codelineno-9-33 href=#__codelineno-9-33></a>                <span class=n>decrypted</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>columns</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=n>i</span><span class=p>])</span>
</span><span id=__span-9-34><a id=__codelineno-9-34 name=__codelineno-9-34 href=#__codelineno-9-34></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>decrypted</span><span class=p>)</span>
</span></code></pre></div> <h4 id=cryptanalysis_4>Cryptanalysis<a class=headerlink href=#cryptanalysis_4 title="Permanent link">&para;</a></h4> <p>For short permutations (up to 6 letters), a brute-force algorithm can test all permutations.</p> <p>Otherwise, by knowing a word of the plain text (if possible with unusual letters), it is possible to find the position of its letters and to deduce the compatible columns permutations.</p> <p>To make it stronger, a <a href=https://en.wikipedia.org/wiki/Transposition_cipher#Double_transposition>double transposition</a> was often used. This is simply a columnar transposition applied twice. The same key can be used for both transpositions, or two different keys can be used.</p> <h3 id=rail-fence><a href=https://en.wikipedia.org/wiki/Rail_fence_cipher>Rail fence</a><a class=headerlink href=#rail-fence title="Permanent link">&para;</a></h3> <p>In the rail fence cipher, the plaintext is written downwards diagonally on successive "rails" of an imaginary fence, then moving up when the bottom rail is reached, down again when the top rail is reached, and so on until the whole plaintext is written out. The ciphertext is then read off in rows.</p> <h4 id=examples_6>Examples<a class=headerlink href=#examples_6 title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Plaintext</th> <th>rails</th> <th>Ciphertext</th> </tr> </thead> <tbody> <tr> <td>May the Force be with you.</td> <td>3</td> <td>MtFe hua h oc ewt o.yerbiy</td> </tr> <tr> <td>tomorrow is another day</td> <td>4</td> <td>toarorw ne mr sohdyoita</td> </tr> <tr> <td>What we've got here is failure to communicate.</td> <td>5</td> <td>Wveaoih'ehrfit ncae e l cuatwgt sueomt. oirme</td> </tr> </tbody> </table> <h4 id=implementation_6>Implementation<a class=headerlink href=#implementation_6 title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=kn>from</span><span class=w> </span><span class=nn>itertools</span><span class=w> </span><span class=kn>import</span> <span class=n>accumulate</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=k>def</span><span class=w> </span><span class=nf>encrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>rails</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>    <span class=k>if</span> <span class=n>rails</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>:</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;rails must be at least 2: </span><span class=si>{</span><span class=n>rails</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>    <span class=n>rows</span> <span class=o>=</span> <span class=p>[[]</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>rails</span><span class=p>)]</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>    <span class=n>cycle</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>rails</span> <span class=o>-</span> <span class=mi>2</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>    <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>msg</span><span class=p>:</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>        <span class=n>row</span> <span class=o>=</span> <span class=n>cycle</span> <span class=o>-</span> <span class=n>i</span> <span class=k>if</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=n>rails</span> <span class=o>-</span> <span class=mi>1</span> <span class=k>else</span> <span class=n>i</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>        <span class=n>rows</span><span class=p>[</span><span class=n>row</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>        <span class=n>i</span> <span class=o>=</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=n>cycle</span>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>row</span><span class=p>)</span> <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>rows</span><span class=p>)</span>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a>
</span><span id=__span-10-15><a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a><span class=k>def</span><span class=w> </span><span class=nf>decrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>rails</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-10-16><a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a>    <span class=k>if</span> <span class=n>rails</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>:</span>
</span><span id=__span-10-17><a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;rails must be at least 2: </span><span class=si>{</span><span class=n>rails</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-10-18><a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a>    <span class=n>cycle</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>rails</span> <span class=o>-</span> <span class=mi>2</span>
</span><span id=__span-10-19><a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a>    <span class=n>k</span><span class=p>,</span> <span class=n>r</span> <span class=o>=</span> <span class=nb>divmod</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>msg</span><span class=p>),</span> <span class=n>cycle</span><span class=p>)</span>
</span><span id=__span-10-20><a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a>    <span class=n>sizes</span> <span class=o>=</span> <span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=mi>2</span> <span class=o>*</span> <span class=n>k</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=n>rails</span> <span class=o>-</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>[</span><span class=n>k</span><span class=p>]</span>
</span><span id=__span-10-21><a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>r</span><span class=p>):</span>
</span><span id=__span-10-22><a id=__codelineno-10-22 name=__codelineno-10-22 href=#__codelineno-10-22></a>        <span class=n>row</span> <span class=o>=</span> <span class=n>cycle</span> <span class=o>-</span> <span class=n>i</span> <span class=k>if</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=n>rails</span> <span class=o>-</span> <span class=mi>1</span> <span class=k>else</span> <span class=n>i</span>
</span><span id=__span-10-23><a id=__codelineno-10-23 name=__codelineno-10-23 href=#__codelineno-10-23></a>        <span class=n>sizes</span><span class=p>[</span><span class=n>row</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-10-24><a id=__codelineno-10-24 name=__codelineno-10-24 href=#__codelineno-10-24></a>
</span><span id=__span-10-25><a id=__codelineno-10-25 name=__codelineno-10-25 href=#__codelineno-10-25></a>    <span class=n>row_indices</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>accumulate</span><span class=p>(</span><span class=n>sizes</span><span class=p>,</span> <span class=n>initial</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span>
</span><span id=__span-10-26><a id=__codelineno-10-26 name=__codelineno-10-26 href=#__codelineno-10-26></a>    <span class=n>row_indices</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span><span id=__span-10-27><a id=__codelineno-10-27 name=__codelineno-10-27 href=#__codelineno-10-27></a>
</span><span id=__span-10-28><a id=__codelineno-10-28 name=__codelineno-10-28 href=#__codelineno-10-28></a>    <span class=n>used</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>rails</span>
</span><span id=__span-10-29><a id=__codelineno-10-29 name=__codelineno-10-29 href=#__codelineno-10-29></a>    <span class=n>decrypted</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-10-30><a id=__codelineno-10-30 name=__codelineno-10-30 href=#__codelineno-10-30></a>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>k</span> <span class=o>+</span> <span class=p>(</span><span class=n>r</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)):</span>
</span><span id=__span-10-31><a id=__codelineno-10-31 name=__codelineno-10-31 href=#__codelineno-10-31></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>cycle</span><span class=p>):</span>
</span><span id=__span-10-32><a id=__codelineno-10-32 name=__codelineno-10-32 href=#__codelineno-10-32></a>            <span class=n>row</span> <span class=o>=</span> <span class=n>cycle</span> <span class=o>-</span> <span class=n>i</span> <span class=k>if</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=n>rails</span> <span class=o>-</span> <span class=mi>1</span> <span class=k>else</span> <span class=n>i</span>
</span><span id=__span-10-33><a id=__codelineno-10-33 name=__codelineno-10-33 href=#__codelineno-10-33></a>            <span class=n>char_idx</span> <span class=o>=</span> <span class=n>row_indices</span><span class=p>[</span><span class=n>row</span><span class=p>]</span>
</span><span id=__span-10-34><a id=__codelineno-10-34 name=__codelineno-10-34 href=#__codelineno-10-34></a>            <span class=k>if</span> <span class=n>used</span><span class=p>[</span><span class=n>row</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>sizes</span><span class=p>[</span><span class=n>row</span><span class=p>]:</span>
</span><span id=__span-10-35><a id=__codelineno-10-35 name=__codelineno-10-35 href=#__codelineno-10-35></a>                <span class=k>break</span>
</span><span id=__span-10-36><a id=__codelineno-10-36 name=__codelineno-10-36 href=#__codelineno-10-36></a>            <span class=n>used</span><span class=p>[</span><span class=n>row</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-10-37><a id=__codelineno-10-37 name=__codelineno-10-37 href=#__codelineno-10-37></a>            <span class=n>row_indices</span><span class=p>[</span><span class=n>row</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-10-38><a id=__codelineno-10-38 name=__codelineno-10-38 href=#__codelineno-10-38></a>            <span class=n>decrypted</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>msg</span><span class=p>[</span><span class=n>char_idx</span><span class=p>])</span>
</span><span id=__span-10-39><a id=__codelineno-10-39 name=__codelineno-10-39 href=#__codelineno-10-39></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>decrypted</span><span class=p>)</span>
</span></code></pre></div> <h4 id=cryptanalysis_5>Cryptanalysis<a class=headerlink href=#cryptanalysis_5 title="Permanent link">&para;</a></h4> <p>Rail fence can be cracked by testing each <code>rails</code> from 2 to <span class=arithmatex>\(L - 1\)</span> where <span class=arithmatex>\(L\)</span> is the length of the plaintext.</p> <h3 id=route><a href=https://en.wikipedia.org/wiki/Transposition_cipher#Route_cipher>Route</a><a class=headerlink href=#route title="Permanent link">&para;</a></h3> <p>Route transposition uses a square or rectangular grid to disarrange a text. The text is written into the grid by one route, and taken out of the grid by another route.</p> <h4 id=diagonal-pattern>Diagonal pattern<a class=headerlink href=#diagonal-pattern title="Permanent link">&para;</a></h4> <p>plaintext is placed first in a top-left to bottom-right manner:</p> <p><img alt src=diagonal.png></p> <p>The blue cells are filled first, followed by the red cells, then the yellow cells, and so on, until we reach the end of plaintext. The arrow indicates the order in which the cells are filled. All empty cells are filled with <code>' '</code>.</p> <p>The number of columns is chosen such that the rightmost column will not be empty after filling in plaintext.</p> <p>ciphertext is then formed by appending all characters of the matrix in a row-wise fashion.</p> <p><img alt src=diagonal_2.png></p> <p>The characters in the blue cells are appended first to encodedText, then the red cells, and so on, and finally the yellow cells. The arrow indicates the order in which the cells are accessed.</p> <p>Note that even if the number of rows is fixed, there may be multiple ways to encrypt a plaintext, depending on the number of columns. For example, if <code>plaintext = "atallcost"</code>, and <code>rows = 3</code>, then ciphertext is <code>alot tls ac</code> if we use 4 columns whereas ciphertext is <code>alo tls act</code> if we use 5 columns. The examples and implementation below uses the fewest columns so that the ciphertext is as short as possible.</p> <h5 id=examples_7>Examples<a class=headerlink href=#examples_7 title="Permanent link">&para;</a></h5> <table> <thead> <tr> <th>Plaintext</th> <th>rows</th> <th>Ciphertext</th> </tr> </thead> <tbody> <tr> <td>attack tonight</td> <td>3</td> <td>aa nh tctit tkog</td> </tr> <tr> <td>tomorrow is another day</td> <td>5</td> <td>trst y oo hd mwaea o nr rio</td> </tr> <tr> <td>What we've got here is failure to communicate.</td> <td>6</td> <td>Weoea mc! h't itma av ilout tehsu ne e rci wgrfeo</td> </tr> </tbody> </table> <h5 id=implementation_7>Implementation<a class=headerlink href=#implementation_7 title="Permanent link">&para;</a></h5> <div class="language-python highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=kn>from</span><span class=w> </span><span class=nn>math</span><span class=w> </span><span class=kn>import</span> <span class=n>ceil</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=kn>from</span><span class=w> </span><span class=nn>typing</span><span class=w> </span><span class=kn>import</span> <span class=n>Iterator</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=k>def</span><span class=w> </span><span class=nf>encrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>rows</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>    <span class=n>cols</span> <span class=o>=</span> <span class=n>find_width</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>msg</span><span class=p>),</span> <span class=n>rows</span><span class=p>)</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>    <span class=n>matrix</span> <span class=o>=</span> <span class=p>[[</span><span class=s2>&quot; &quot;</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>cols</span><span class=p>)]</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>rows</span><span class=p>)]</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>    <span class=k>for</span> <span class=n>r</span><span class=p>,</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>diagonal_traversal</span><span class=p>(</span><span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>):</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>        <span class=k>if</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>msg</span><span class=p>):</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>            <span class=n>matrix</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>c</span><span class=p>]</span> <span class=o>=</span> <span class=n>msg</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>            <span class=k>break</span>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>row</span><span class=p>)</span> <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>matrix</span><span class=p>)</span>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a><span class=k>def</span><span class=w> </span><span class=nf>decrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>rows</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>    <span class=n>cols</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span> <span class=o>//</span> <span class=n>rows</span>
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>    <span class=n>matrix</span> <span class=o>=</span> <span class=p>[[</span><span class=s2>&quot; &quot;</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>cols</span><span class=p>)]</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>rows</span><span class=p>)]</span>
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>s</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>msg</span><span class=p>):</span>
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a>        <span class=n>r</span><span class=p>,</span> <span class=n>c</span> <span class=o>=</span> <span class=nb>divmod</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>cols</span><span class=p>)</span>
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a>        <span class=n>matrix</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>c</span><span class=p>]</span> <span class=o>=</span> <span class=n>s</span>
</span><span id=__span-11-22><a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a>    <span class=n>decrypted</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-11-23><a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a>    <span class=k>for</span> <span class=n>r</span><span class=p>,</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>diagonal_traversal</span><span class=p>(</span><span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>):</span>
</span><span id=__span-11-24><a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a>        <span class=n>decrypted</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>matrix</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>c</span><span class=p>])</span>
</span><span id=__span-11-25><a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>decrypted</span><span class=p>)</span><span class=o>.</span><span class=n>rstrip</span><span class=p>()</span>
</span><span id=__span-11-26><a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a>
</span><span id=__span-11-27><a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a><span class=k>def</span><span class=w> </span><span class=nf>find_width</span><span class=p>(</span><span class=n>size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>rows</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span><span id=__span-11-28><a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a>    <span class=k>return</span> <span class=nb>max</span><span class=p>(</span><span class=n>rows</span><span class=p>,</span> <span class=n>ceil</span><span class=p>((</span><span class=n>size</span> <span class=o>+</span> <span class=n>rows</span> <span class=o>*</span> <span class=p>(</span><span class=n>rows</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span><span class=p>)</span> <span class=o>/</span> <span class=n>rows</span><span class=p>))</span>
</span><span id=__span-11-29><a id=__codelineno-11-29 name=__codelineno-11-29 href=#__codelineno-11-29></a>
</span><span id=__span-11-30><a id=__codelineno-11-30 name=__codelineno-11-30 href=#__codelineno-11-30></a><span class=k>def</span><span class=w> </span><span class=nf>diagonal_traversal</span><span class=p>(</span><span class=n>rows</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>cols</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Iterator</span><span class=p>[</span><span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]]:</span>
</span><span id=__span-11-31><a id=__codelineno-11-31 name=__codelineno-11-31 href=#__codelineno-11-31></a>    <span class=k>for</span> <span class=n>diff</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>cols</span><span class=p>):</span>
</span><span id=__span-11-32><a id=__codelineno-11-32 name=__codelineno-11-32 href=#__codelineno-11-32></a>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>min</span><span class=p>(</span><span class=n>rows</span><span class=p>,</span> <span class=n>cols</span> <span class=o>-</span> <span class=n>diff</span><span class=p>)):</span>
</span><span id=__span-11-33><a id=__codelineno-11-33 name=__codelineno-11-33 href=#__codelineno-11-33></a>            <span class=k>yield</span> <span class=p>(</span><span class=n>j</span><span class=p>,</span> <span class=n>j</span> <span class=o>+</span> <span class=n>diff</span><span class=p>)</span>
</span></code></pre></div> <h4 id=spiral-pattern>Spiral pattern<a class=headerlink href=#spiral-pattern title="Permanent link">&para;</a></h4> <p>The examples and implementation below assumes the route to be "spiral inwards, clockwise, starting from the top left".</p> <h5 id=examples_8>Examples<a class=headerlink href=#examples_8 title="Permanent link">&para;</a></h5> <table> <thead> <tr> <th>Plaintext</th> <th>width</th> <th>Ciphertext</th> </tr> </thead> <tbody> <tr> <td>May the Force be with you.</td> <td>4</td> <td>May ceto.uh eFtherbiy w o</td> </tr> <tr> <td>tomorrow is another day</td> <td>5</td> <td>tomorio yadtsrow nreh a</td> </tr> <tr> <td>What we've got here is failure to communicate.</td> <td>6</td> <td>What wgrfeoc.etam aeoe've e rcinumti t hsu oli</td> </tr> </tbody> </table> <h5 id=implementation_8>Implementation<a class=headerlink href=#implementation_8 title="Permanent link">&para;</a></h5> <div class="language-python highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=kn>from</span><span class=w> </span><span class=nn>math</span><span class=w> </span><span class=kn>import</span> <span class=n>ceil</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=kn>from</span><span class=w> </span><span class=nn>typing</span><span class=w> </span><span class=kn>import</span> <span class=n>Iterator</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=k>def</span><span class=w> </span><span class=nf>encrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>width</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>    <span class=n>rows</span> <span class=o>=</span> <span class=n>ceil</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span> <span class=o>/</span> <span class=n>width</span><span class=p>)</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a>    <span class=n>matrix</span> <span class=o>=</span> <span class=p>[[</span><span class=s2>&quot;&quot;</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>width</span><span class=p>)]</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>rows</span><span class=p>)]</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>char</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>msg</span><span class=p>):</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>        <span class=n>r</span><span class=p>,</span> <span class=n>c</span> <span class=o>=</span> <span class=nb>divmod</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>width</span><span class=p>)</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a>        <span class=n>matrix</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>c</span><span class=p>]</span> <span class=o>=</span> <span class=n>char</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>matrix</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>c</span><span class=p>]</span> <span class=k>for</span> <span class=n>r</span><span class=p>,</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>clockwise_traversal</span><span class=p>(</span><span class=n>rows</span><span class=p>,</span> <span class=n>width</span><span class=p>))</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a><span class=k>def</span><span class=w> </span><span class=nf>decrypt</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>width</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a>    <span class=n>full_rows</span><span class=p>,</span> <span class=n>remainder</span> <span class=o>=</span> <span class=nb>divmod</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>msg</span><span class=p>),</span> <span class=n>width</span><span class=p>)</span>
</span><span id=__span-12-14><a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a>    <span class=n>rows</span> <span class=o>=</span> <span class=n>full_rows</span> <span class=o>+</span> <span class=p>(</span><span class=n>remainder</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-12-15><a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a>    <span class=n>res</span> <span class=o>=</span> <span class=p>[[</span><span class=s2>&quot;&quot;</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>width</span><span class=p>)]</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>rows</span><span class=p>)]</span>
</span><span id=__span-12-16><a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a>    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-12-17><a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a>    <span class=k>for</span> <span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>c</span><span class=p>)</span> <span class=ow>in</span> <span class=n>clockwise_traversal</span><span class=p>(</span><span class=n>rows</span><span class=p>,</span> <span class=n>width</span><span class=p>):</span>
</span><span id=__span-12-18><a id=__codelineno-12-18 name=__codelineno-12-18 href=#__codelineno-12-18></a>        <span class=k>if</span> <span class=n>r</span> <span class=o>&lt;</span> <span class=n>rows</span> <span class=o>-</span> <span class=mi>1</span> <span class=ow>or</span> <span class=n>c</span> <span class=o>&lt;</span> <span class=n>remainder</span><span class=p>:</span>
</span><span id=__span-12-19><a id=__codelineno-12-19 name=__codelineno-12-19 href=#__codelineno-12-19></a>            <span class=n>res</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>c</span><span class=p>]</span> <span class=o>=</span> <span class=n>msg</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span><span id=__span-12-20><a id=__codelineno-12-20 name=__codelineno-12-20 href=#__codelineno-12-20></a>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-12-21><a id=__codelineno-12-21 name=__codelineno-12-21 href=#__codelineno-12-21></a>    <span class=k>return</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>row</span><span class=p>)</span> <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>res</span><span class=p>)</span>
</span><span id=__span-12-22><a id=__codelineno-12-22 name=__codelineno-12-22 href=#__codelineno-12-22></a>
</span><span id=__span-12-23><a id=__codelineno-12-23 name=__codelineno-12-23 href=#__codelineno-12-23></a><span class=k>def</span><span class=w> </span><span class=nf>clockwise_traversal</span><span class=p>(</span><span class=n>rows</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>cols</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Iterator</span><span class=p>[</span><span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]]:</span>
</span><span id=__span-12-24><a id=__codelineno-12-24 name=__codelineno-12-24 href=#__codelineno-12-24></a>    <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>((</span><span class=nb>min</span><span class=p>(</span><span class=n>rows</span><span class=p>,</span> <span class=n>cols</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span><span class=p>):</span>
</span><span id=__span-12-25><a id=__codelineno-12-25 name=__codelineno-12-25 href=#__codelineno-12-25></a>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=n>cols</span> <span class=o>-</span> <span class=n>k</span><span class=p>):</span>
</span><span id=__span-12-26><a id=__codelineno-12-26 name=__codelineno-12-26 href=#__codelineno-12-26></a>            <span class=k>yield</span> <span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=n>j</span><span class=p>)</span>
</span><span id=__span-12-27><a id=__codelineno-12-27 name=__codelineno-12-27 href=#__codelineno-12-27></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>rows</span> <span class=o>-</span> <span class=n>k</span><span class=p>):</span>
</span><span id=__span-12-28><a id=__codelineno-12-28 name=__codelineno-12-28 href=#__codelineno-12-28></a>            <span class=k>yield</span> <span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>cols</span> <span class=o>-</span> <span class=n>k</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-12-29><a id=__codelineno-12-29 name=__codelineno-12-29 href=#__codelineno-12-29></a>        <span class=k>if</span> <span class=n>rows</span> <span class=o>-</span> <span class=n>k</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>!=</span> <span class=n>k</span> <span class=ow>and</span> <span class=n>cols</span> <span class=o>-</span> <span class=n>k</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>!=</span> <span class=n>k</span><span class=p>:</span>
</span><span id=__span-12-30><a id=__codelineno-12-30 name=__codelineno-12-30 href=#__codelineno-12-30></a>            <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>cols</span> <span class=o>-</span> <span class=n>k</span> <span class=o>-</span> <span class=mi>2</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span><span id=__span-12-31><a id=__codelineno-12-31 name=__codelineno-12-31 href=#__codelineno-12-31></a>                <span class=k>yield</span> <span class=p>(</span><span class=n>rows</span> <span class=o>-</span> <span class=n>k</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>j</span><span class=p>)</span>
</span><span id=__span-12-32><a id=__codelineno-12-32 name=__codelineno-12-32 href=#__codelineno-12-32></a>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>rows</span> <span class=o>-</span> <span class=n>k</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span><span id=__span-12-33><a id=__codelineno-12-33 name=__codelineno-12-33 href=#__codelineno-12-33></a>                <span class=k>yield</span> <span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>k</span><span class=p>)</span>
</span></code></pre></div> <h4 id=cryptanalysis_6>Cryptanalysis<a class=headerlink href=#cryptanalysis_6 title="Permanent link">&para;</a></h4> <p>Route ciphers have many more keys than a rail fence. The number of possible keys is potentially too great to be enumerated even by modern machinery for messages of reasonable length. Badly chosen routes, however, will leave excessive chunks of plaintext, or text simply reversed, and this will give cryptanalysts a clue as to the routes.</p> <p><a href=https://ko-fi.com/T6T416OJAV><img alt=ko-fi src=https://ko-fi.com/img/githubbutton_sm.svg></a></p> <h2 id=__comments>Comments</h2> <script src=https://giscus.app/client.js data-repo=yukuairoy/codespree data-repo-id=R_kgDONWSfww data-category=Announcements data-category-id=DIC_kwDONWSfw84Cks8Z data-mapping=title data-strict=1 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async>
  </script> <!-- Synchronize Giscus theme with palette --> <script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate"
        ? "transparent_dark"
        : "light"

      // Instruct Giscus to set theme
      giscus.setAttribute("data-theme", theme) 
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate"
            ? "transparent_dark"
            : "light"

          // Instruct Giscus to change theme
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 <a href=https://www.linkedin.com/in/kuai/ >Kuai Yu</a>, All Rights Reserved. </div> </div> <div class=md-social> <a href=https://www.linkedin.com/in/kuai/ target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://www.github.com/yukuairoy target=_blank rel=noopener title=www.github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://www.instagram.com/realkuaiyu target=_blank rel=noopener title=www.instagram.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141m0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7m146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8m76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8M398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.expand"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.60a45f97.min.js></script> <script src=../../javascripts/mathjax.js></script> <script src=https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>